<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BadgeSort - Interactive Badge Generator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: #f9fafb;
            line-height: 1.6;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }
        .header {
            text-align: center;
            margin-bottom: 2rem;
        }
        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #9333ea 0%, #ec4899 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }
        .header p {
            color: #6b7280;
            font-size: 1.125rem;
        }
        .header a {
            color: #9333ea;
            text-decoration: none;
            font-size: 0.875rem;
        }
        .header a:hover {
            color: #7e22ce;
        }
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }
        @media (max-width: 1024px) {
            .grid {
                grid-template-columns: 1fr;
            }
        }
        .panel {
            background: white;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
        }
        .panel h2 {
            font-size: 1.5rem;
            font-weight: 700;
            color: #111827;
            margin-bottom: 1rem;
        }
        .panel h3 {
            font-size: 1.25rem;
            font-weight: 700;
            color: #111827;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
        }
        .form-group {
            margin-bottom: 1rem;
        }
        .form-group label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            color: #374151;
            margin-bottom: 0.5rem;
        }
        .form-group input[type="text"],
        .form-group input[type="number"],
        .form-group select {
            width: 100%;
            padding: 0.5rem;
            border: 2px solid #e5e7eb;
            border-radius: 0.375rem;
            font-size: 1rem;
        }
        .form-group input[type="text"]:focus,
        .form-group input[type="number"]:focus,
        .form-group select:focus {
            outline: none;
            border-color: #9333ea;
        }
        .checkbox-group {
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
        }
        .checkbox-group input[type="checkbox"] {
            margin-right: 0.5rem;
            width: 1rem;
            height: 1rem;
        }
        .checkbox-group label {
            font-size: 0.875rem;
            color: #374151;
        }
        .badge-preview {
            min-height: 100px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 0.5rem;
            padding: 1rem;
        }
        .badge-preview img {
            display: inline-block;
            margin: 0.25rem;
        }
        .yaml-output {
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
            background: #1e293b;
            color: #e2e8f0;
            border-radius: 0.5rem;
            padding: 1rem;
            white-space: pre-wrap;
            word-wrap: break-word;
            max-height: 400px;
            overflow-y: auto;
        }
        .icon-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 0.5rem;
            max-height: 400px;
            overflow-y: auto;
            padding: 1rem;
            border: 2px solid #e2e8f0;
            border-radius: 0.5rem;
        }
        .icon-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 0.5rem;
            border-radius: 0.375rem;
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid transparent;
        }
        .icon-item:hover {
            background-color: #f1f5f9;
            transform: translateY(-2px);
        }
        .icon-item.selected {
            border-color: #667eea;
            background-color: #eef2ff;
        }
        .icon-item svg {
            width: 32px;
            height: 32px;
            margin-bottom: 0.25rem;
        }
        .icon-item span {
            font-size: 0.75rem;
            text-align: center;
            word-break: break-word;
        }
        .search-input {
            width: 100%;
            padding: 0.5rem;
            border: 2px solid #e5e7eb;
            border-radius: 0.375rem;
            margin-bottom: 1rem;
            font-size: 1rem;
        }
        .search-input:focus {
            outline: none;
            border-color: #9333ea;
        }
        .button-group {
            margin-bottom: 1rem;
        }
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: transform 0.2s;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
        }
        .btn-secondary {
            background: #64748b;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: transform 0.2s;
        }
        .btn-secondary:hover {
            transform: translateY(-2px);
        }
        .loading {
            text-align: center;
            padding: 2rem;
            color: #6b7280;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>BadgeSort</h1>
            <p>Interactive Badge Generator for GitHub Actions</p>
            <a href="https://github.com/ChipWolf/BadgeSort" target="_blank">View on GitHub â†’</a>
        </div>

        <div class="grid">
            <!-- Left Panel: Configuration -->
            <div class="panel">
                <h2>Configuration</h2>
                
                <!-- Badge Style -->
                <div class="form-group">
                    <label>Badge Style</label>
                    <select id="badge-style">
                        <option value="for-the-badge">For The Badge</option>
                        <option value="flat">Flat</option>
                        <option value="flat-square">Flat Square</option>
                        <option value="plastic">Plastic</option>
                        <option value="social">Social</option>
                    </select>
                </div>

                <!-- Sort Algorithm -->
                <div class="form-group">
                    <label>Sort Algorithm</label>
                    <select id="sort-algorithm">
                        <option value="hilbert">Hilbert (Default)</option>
                        <option value="hsv">HSV</option>
                        <option value="step">Step</option>
                        <option value="step_invert">Step Invert</option>
                        <option value="luminance">Luminance</option>
                        <option value="random">Random</option>
                    </select>
                </div>

                <!-- Output Format -->
                <div class="form-group">
                    <label>Output Format</label>
                    <select id="output-format">
                        <option value="markdown">Markdown</option>
                        <option value="html">HTML</option>
                    </select>
                </div>

                <!-- Badge ID -->
                <div class="form-group">
                    <label>Badge ID</label>
                    <input type="text" id="badge-id" value="default">
                </div>

                <!-- Output File -->
                <div class="form-group">
                    <label>Output File</label>
                    <input type="text" id="output-file" value="README.md">
                </div>

                <!-- Additional Options -->
                <div class="checkbox-group">
                    <input type="checkbox" id="reverse-sort">
                    <label>Reverse Sort Order</label>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="show-badgesort" checked>
                    <label>Show BadgeSort Badge</label>
                </div>

                <div class="form-group">
                    <label>Hue Rotate (for step sort)</label>
                    <input type="number" id="hue-rotate" value="0" min="0" max="360">
                </div>

                <!-- Badge Selection -->
                <h3>Select Badges</h3>
                <input type="text" id="search-input" class="search-input" placeholder="Search icons...">
                <div class="button-group">
                    <button id="select-popular" class="btn-secondary" style="margin-right: 0.5rem;">Popular Tech</button>
                    <button id="clear-selection" class="btn-secondary">Clear All</button>
                </div>
                <div id="icon-grid" class="icon-grid"></div>
            </div>

            <!-- Right Panel: Preview & Output -->
            <div class="panel">
                <h2>Preview</h2>
                <div id="badge-preview" class="badge-preview" style="margin-bottom: 1.5rem;">
                    <div class="loading">Select badges to see preview</div>
                </div>

                <h2>GitHub Actions YAML</h2>
                <div style="margin-bottom: 1rem;">
                    <button id="copy-yaml" class="btn-primary" style="width: 100%;">
                        ðŸ“‹ Copy YAML to Clipboard
                    </button>
                </div>
                <div id="yaml-output" class="yaml-output"></div>
            </div>
        </div>
    </div>

    <script>
// Simple Icons data - embedded
let iconsData = null;
let selectedSlugs = [];

// Load Simple Icons data from embedded data
async function loadIcons() {
    try {
        // Load from external file
        const response = await fetch('icons_data.json');
        iconsData = await response.json();
        renderIconGrid();
        updateYAML();
    } catch (error) {
        // Fallback: show error message with instructions
        document.getElementById('icon-grid').innerHTML = `
            <div class="loading">
                <p>Loading icons...</p>
                <p style="font-size: 0.875rem; margin-top: 0.5rem;">If icons don't load, this page requires a web server to function properly.</p>
            </div>`;
    }
}

function encodeTitle(title) {
    return encodeURIComponent(title).replace(/-/g, '--');
}

function calculateBrightness(hexColor) {
    const r = parseInt(hexColor.substring(0, 2), 16);
    const g = parseInt(hexColor.substring(2, 4), 16);
    const b = parseInt(hexColor.substring(4, 6), 16);
    return (r * 299 + g * 587 + b * 114) / 255000;
}

function getBadgeURL(icon, style) {
    const titleSafe = encodeTitle(icon.title);
    const brightness = calculateBrightness(icon.hex);
    const logoColor = brightness <= 0.7 ? 'white' : 'black';
    return `https://img.shields.io/badge/${titleSafe}-${icon.hex}.svg?style=${style}&logo=${icon.slug}&logoColor=${logoColor}`;
}

function renderIconGrid(filterText = '') {
    const grid = document.getElementById('icon-grid');
    if (!iconsData) {
        grid.innerHTML = '<div class="loading">Loading icons...</div>';
        return;
    }
    
    grid.innerHTML = '';
    const icons = iconsData.icons || [];
    const filtered = icons.filter(icon => 
        icon.slug.toLowerCase().includes(filterText.toLowerCase()) ||
        icon.title.toLowerCase().includes(filterText.toLowerCase())
    ).slice(0, 200); // Limit to 200 for performance
    
    filtered.forEach(icon => {
        const item = document.createElement('div');
        item.className = 'icon-item';
        if (selectedSlugs.includes(icon.slug)) {
            item.className += ' selected';
        }
        
        const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
        svg.setAttribute('viewBox', '0 0 24 24');
        svg.setAttribute('fill', `#${icon.hex}`);
        svg.style.width = '32px';
        svg.style.height = '32px';
        svg.style.marginBottom = '0.25rem';
        
        const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
        path.setAttribute('d', icon.path);
        svg.appendChild(path);
        
        const label = document.createElement('span');
        label.textContent = icon.title;
        
        item.appendChild(svg);
        item.appendChild(label);
        
        item.onclick = () => toggleIcon(icon.slug);
        grid.appendChild(item);
    });
}

function toggleIcon(slug) {
    const index = selectedSlugs.indexOf(slug);
    if (index > -1) {
        selectedSlugs.splice(index, 1);
    } else {
        selectedSlugs.push(slug);
    }
    
    renderIconGrid(document.getElementById('search-input').value);
    updatePreview();
    updateYAML();
}

function updatePreview() {
    const preview = document.getElementById('badge-preview');
    const style = document.getElementById('badge-style').value;
    
    if (selectedSlugs.length === 0) {
        preview.innerHTML = '<div class="loading">Select badges to see preview</div>';
        return;
    }
    
    let html = '';
    selectedSlugs.forEach(slug => {
        const icon = iconsData.icons.find(i => i.slug === slug);
        if (icon) {
            const badgeURL = getBadgeURL(icon, style);
            html += `<img src="${badgeURL}" alt="${icon.title}">`;
        }
    });
    
    preview.innerHTML = html;
}

function updateYAML() {
    const output = document.getElementById('yaml-output');
    
    if (selectedSlugs.length === 0) {
        output.textContent = '# Select badges to generate YAML';
        return;
    }
    
    const style = document.getElementById('badge-style').value;
    const sortAlgo = document.getElementById('sort-algorithm').value;
    const outputFormat = document.getElementById('output-format').value;
    const badgeId = document.getElementById('badge-id').value;
    const outputFile = document.getElementById('output-file').value;
    const reverseSort = document.getElementById('reverse-sort').checked;
    const showBadgesort = document.getElementById('show-badgesort').checked;
    const hueRotate = document.getElementById('hue-rotate').value;
    
    const slugsYAML = selectedSlugs.join('\n            ');
    
    let yamlContent = `# Add this to your GitHub Actions workflow
      - uses: docker://ghcr.io/chipwolf/badgesort:latest
        with:
          format: ${outputFormat}
          id: ${badgeId}
          output: ${outputFile}
          slugs: |
            ${slugsYAML}
          sort: ${sortAlgo}
          style: ${style}
          thanks: ${showBadgesort}`;
    
    if (reverseSort || (['step', 'step_invert'].includes(sortAlgo) && hueRotate !== '0')) {
        yamlContent += '\n          opts: |';
        if (reverseSort) {
            yamlContent += '\n            --reverse';
        }
        if (['step', 'step_invert'].includes(sortAlgo) && hueRotate !== '0') {
            yamlContent += `\n            --hue-rotate ${hueRotate}`;
        }
    }
    
    output.textContent = yamlContent;
}

function copyYAML() {
    const yamlText = document.getElementById('yaml-output').textContent;
    navigator.clipboard.writeText(yamlText).then(() => {
        alert('YAML copied to clipboard!');
    }).catch(() => {
        alert('Failed to copy. Please copy manually.');
    });
}

function selectPopular() {
    const popular = ['github', 'python', 'docker', 'kubernetes', 'javascript', 'typescript', 
                     'react', 'nodedotjs', 'git', 'linux', 'amazonaws', 'microsoftazure', 'googlecloud'];
    selectedSlugs = [];
    popular.forEach(slug => {
        if (iconsData && iconsData.icons.find(i => i.slug === slug)) {
            selectedSlugs.push(slug);
        }
    });
    renderIconGrid();
    updatePreview();
    updateYAML();
}

function clearSelection() {
    selectedSlugs = [];
    renderIconGrid();
    updatePreview();
    updateYAML();
}

// Event listeners
document.getElementById('search-input').addEventListener('input', (e) => renderIconGrid(e.target.value));
document.getElementById('badge-style').addEventListener('change', () => { updatePreview(); updateYAML(); });
document.getElementById('sort-algorithm').addEventListener('change', updateYAML);
document.getElementById('output-format').addEventListener('change', updateYAML);
document.getElementById('badge-id').addEventListener('input', updateYAML);
document.getElementById('output-file').addEventListener('input', updateYAML);
document.getElementById('reverse-sort').addEventListener('change', updateYAML);
document.getElementById('show-badgesort').addEventListener('change', updateYAML);
document.getElementById('hue-rotate').addEventListener('input', updateYAML);
document.getElementById('copy-yaml').addEventListener('click', copyYAML);
document.getElementById('select-popular').addEventListener('click', selectPopular);
document.getElementById('clear-selection').addEventListener('click', clearSelection);

// Load icons on page load
loadIcons();
    </script>
</body>
</html>
